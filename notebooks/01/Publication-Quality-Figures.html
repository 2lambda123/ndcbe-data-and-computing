
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.15. Preparing Publication Quality Figures in Python &#8212; Data and Computing for Chemical Engineers</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/01/Publication-Quality-Figures';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2. Advanced Python" href="../02/advanced_python.html" />
    <link rel="prev" title="1.14. Testing and Debugging in Python" href="Testing-and-Debugging.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/cbe_logo.jpg" class="logo__image only-light" alt="Data and Computing for Chemical Engineers - Home"/>
    <script>document.write(`<img src="../../_static/cbe_logo.jpg" class="logo__image only-dark" alt="Data and Computing for Chemical Engineers - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Data and Computing for Engineers
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Python Programming</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Python-Primer.html">1. Python Primer</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Jupyter-Notebooks.html">1.1. Welcome to Jupyter Notebooks and Vocareum</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python-Basics-I-Variables-Strings-Bugs.html">1.2. Python Basics I: Variables, Strings, and Bugs</a></li>
<li class="toctree-l2"><a class="reference internal" href="Flow-control.html">1.3. Python Basics II: Loopy Logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python-Basics-III-Lists-Dictionaries-Enumeration.html">1.4. Python Basics III: Lists, Dictionaries, and Enumeration</a></li>
<li class="toctree-l2"><a class="reference internal" href="Functions-and-Scope.html">1.5. Functions and Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="Recursion.html">1.6. Recursion</a></li>
<li class="toctree-l2"><a class="reference internal" href="Pseudocode.html">1.7. Pseudocode</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example-High-Low-Game.html">1.8. High/Low Guess My Number Game</a></li>
<li class="toctree-l2"><a class="reference internal" href="Modules-and-Files.html">1.9. Modules and Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="NumPy.html">1.10. Linear Algebra with Numpy and Scipy</a></li>
<li class="toctree-l2"><a class="reference internal" href="Matplotlib.html">1.11. Visualization with matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="Pandas.html">1.12. Manipulating Data with Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="Functions-as-Arguments.html">1.13. Functions as Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="Testing-and-Debugging.html">1.14. Testing and Debugging in Python</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">1.15. Preparing Publication Quality Figures in Python</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../02/advanced_python.html">2. Advanced Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Numerical Methods</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../03/linear_algebra.html">3. Linear Algebra Primer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../03/chapter1.html">3.1. Chapter 1: Math Fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/chapter2.html">3.2. Chapter 2: Intro to Linear Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/chapter3.html">3.3. Chapter 3: Computational linear algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/chapter4.html">3.4. Chapter 4: Geometric Aspects of Linear Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/chapter5.html">3.5. Chapter 5: Linear Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/chapter6.html">3.6. Chapter 6: Theoretical Linear Algebra</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../04/linear_algebra.html">4. Applied Linear Algebra</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../04/Modeling-Systems-of-Linear-Equations.html">4.1. Modeling Systems of Linear Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/Gauss-Elimination.html">4.2. Gaussian Elimination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/Invertible-Matrix-Theorem-and-Gauss-Example.html">4.3. Invertible Matrix Theorem and Gaussian Elimination Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/LU-Decomposition.html">4.4. LU Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/Condition-Number.html">4.5. Errors in Linear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/Example-Atomic-Mass-Balances.html">4.6. Example: Mass Balances and Linear Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/Linear-Algebra-in-Numpy.html">4.7. Linear Algebra Review and SciPy Basics</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../05/algorithms.html">5. Algorithm Building Blocks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../05/Taylor-Series.html">5.1. Taylor Series Approximations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05/Finite-Difference.html">5.2. Finite Difference Derivative Approximations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05/Example-Heating-a-Metal-Slab.html">5.3. Example: Heating a Metal Slab</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../06/nonlinear_systems.html">6. Nonlinear Systems of Equations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../06/Modeling-Systems-of-Nonlinear-Equations.html">6.1. Modeling Systems of Nonlinear Equations: Flash Calculation Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/Newton-Raphson-Method-in-One-Dimension.html">6.2. Newton-Raphson Method in One Dimension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/More-Newton-Type-Methods.html">6.3. More Newton-Type Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/Convergence-Analysis-for-Newton-Raphson-Methods.html">6.4. Convergence Analysis for Newton-Raphson Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/Newton-Raphson-Methods-for-Systems-of-Equations.html">6.5. Newton-Raphson Methods for Systems of Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/Newton-Methods-in-Scipy.html">6.6. Newton Methods in Scipy</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../07/integration.html">7. Numeric Integration</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../07/Intro-and-Newton-Cotes.html">7.1. Introduction and Newton-Cotes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/Gauss-Quadrature.html">7.2. Gauss Quadrature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/Scipy-Library-Adaptive-Methods-for-Newton-Cotes-and-Gauss-Quadrature.html">7.3. Scipy Library: Adaptive Methods for Newton-Cotes and Gauss Quadrature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/Application-Inertial-Navigation-Systems.html">7.4. Application: Inertial Navigation Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/Forward-and-Backward-Euler.html">7.5. Forward and Backward Euler Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/Trapezoid-Rule.html">7.6. Crank-Nicolson (Trapezoid Rule)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/Stability-Analysis.html">7.7. Stability Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/Explicit-Runge-Kutta.html">7.8. Explicit Range Kutta Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/Systems-of-Differential-Equations-and-Scipy.html">7.9. Systems of Differential Equations and Scipy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/Example-Reaction-Rates.html">7.10. Example: Reaction Rates</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../08/optimization.html">8. Continuous Optimization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../08/Pyomo-Basics.html">8.1. Pyomo Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08/Electricity-Market-Optimization.html">8.2. Electricity Market Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08/Flash-Calculations-in-Pyomo.html">8.3. Flash Calculations in Pyomo</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../09/stats.html">9. Descriptive Statistics and Visualization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../09/Sampling.html">9.1. Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09/Summary-Statistics.html">9.2. Summary Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09/Visualizing-Data.html">9.3. Visualizing Data</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../10/probability.html">10. Probability Theory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../10/Probability-Basics.html">10.1. Basic Ideas of Probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/Random-Variables.html">10.2. Random Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/Jointly-Distributed-Random-Variables.html">10.3. Jointly Distributed Random Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/Jointly-Continuous-Random-Variables.html">10.4. Jointly Continuous Random Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/Practice-Problems.html">10.5. Practice Problems</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../11/distributions.html">11. Common Probability Distributions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../11/Bernoulli-Probability-Distribution.html">11.1. Bernoulli Probability Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/Binomial-Probability-Distribtuion.html">11.2. Binomial Probability Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/Poisson-Probability-Distribution.html">11.3. Poisson Probability Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/Normal-Probability-Distribution.html">11.4. Normal Probability Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/Common-Probability-Distributions-Summary.html">11.5. Summary</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../12/uncertainty.html">12. Uncertainty and Error Propagation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../12/Measurement-Error.html">12.1. Measurement Error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/Error-Propagation.html">12.2. Error Propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/Measuring-Flowrate-Example.html">12.3. Measuring Flowrate Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/Car-and-Incline-Example.html">12.4. Car and Incline Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/Simulation.html">12.5. Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/Monte-Carlo-Error-Propogation.html">12.6. Monte Carlo Error Propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/Practice-Problems.html">12.7. Practice Problems</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../13/inference.html">13. Statistical Inference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../13/Central-Limit-Theorem.html">13.1. Central Limit Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/Standard-Normal-Distribution.html">13.2. Standard Normal Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/Confidence-Intervals.html">13.3. Confidence Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/Students-t-Distribution.html">13.4. Student’s t-Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/Hypothesis-Testing-Basics.html">13.5. Hypothesis Testing Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/Flavors-of-Hypothesis-Testing.html">13.6. Flavors of Hypothesis Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/Type-I-and-Type-II-Errors.html">13.7. Type I and Type II Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/Statistical-Power-Basics.html">13.8. Statistical Power Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/Statistical-Power-in-Python.html">13.9. Statistical Power in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/Statistical-Power-Practice-Problems.html">13.10. Statistical Power Practice Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/Bootstrap-Confidence-Intervals.html">13.11. Bootstrap Confidence Intervals</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../14/regression.html">14. Multivariate Linear Regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../14/Correlation-Covariance-and-Independence.html">14.1. Correlation, Covariance, and Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/Least-Squares-Line.html">14.2. Simple Least Squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/Ordinary-Least-Squares-Linear-Regression.html">14.3. Ordinary Least Squares Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/Residual-Analysis.html">14.4. Residual Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/Regression-Assumption-Examples.html">14.5. Regression Assumption Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/Uncertainty-Analysis-and-Statistical-Inference.html">14.6. Uncertainty Analysis and Statistical Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/Multivariate-Linear-Regression.html">14.7. Multivariate Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/Linear-Regression-Practice-Problems.html">14.8. Linear Regression Practice Problems</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../15/advanced_regression.html">15. Nonlinear Regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../15/Transformations-and-Linear-Regression.html">15.1. Transformations and Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../15/Weighted-Regression.html">15.2. Weighted Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../15/Nonlinear-Regression.html">15.3. Nonlinear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../15/Nonlinear-Regression-Practice-Problem.html">15.4. Nonlinear Regression Practice Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../15/Monte-Carlo-Uncertainty-Analysis-for-Nonlinear-Regression.html">15.5. Monte Carlo Uncertainty Analysis for Nonlinear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../15/Nonlinear-Case-Study-Adsorptive-Membranes.html">15.6. Nonlinear Regression Case Study: Adsorptive Nanoporous Membranes</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../16/design_of_experiments.html">16. Design of Experiments</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../16/Reaction-MBDoE.html">16.1. Model-Based Design of Experiments</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Extra Information</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../fall2022/home.html">Fall 2022</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../fall2022/syllabus.html">Syllabus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fall2022/schedule.html">Fall 2022 Schedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fall2022/project1.html">Project 1: Computating for Problem Solving (Fall 2022)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fall2022/project2.html">Project 2: Data Analysis (Fall 2022)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../fall2023/home.html">Fall 2023</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../fall2023/syllabus.html">Syllabus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fall2023/schedule.html">Schedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fall2023/project.html">Semester Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assignments/ProblemSet1_F23.html">Problem Set 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assignments/ProblemSet2_F23.html">Problem Set 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assignments/ProblemSet3_F23.html">Problem Set 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assignments/ProblemSet4_F23.html">Problem Set 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assignments/ProblemSet5_F23.html">Problem Set 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assignments/ProblemSet6_F23.html">Problem Set 6</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contrib/contribute.html">Contributed Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Biotransport-Entrance-Length.html">Estimating the Entrance Length of Channel Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Non_Isothermal_PBR.html">Non-Isothermal Packed Bed Reactor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Ficks_Law.html">Solving Fick’s Second Law Using Numeric Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Stochastic-Kinetics.html">Stochastic Simulation of Chemical Reactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Spaghettification.html">Spaghettification of the Magic School Bus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Alcohol-Pharmacokinetics.html">Alcohol Pharmacokinetics and  Blood Alcohol Content % Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/McCabe-Thiele.html">Plotting McCabe-Thiele diagram through computational methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Wastewater-Treatment-Mass-Balance.html">Example of Mass Balance Problem in Wastewater Treatment Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Filtration.html">Filtration of a Yeast Suspension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Fraction_of_Molecular_Collisions.html">Calculating Fraction of Molecular Collisions</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/ndcbe/data-and-computing/blob/master/notebooks/01/Publication-Quality-Figures.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ndcbe/data-and-computing" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ndcbe/data-and-computing/issues/new?title=Issue%20on%20page%20%2Fnotebooks/01/Publication-Quality-Figures.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/01/Publication-Quality-Figures.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Preparing Publication Quality Figures in Python</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">1.15.1. Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-makes-a-scientific-figure-look-great">1.15.2. What makes a scientific figure look great?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-data-and-model-predictions">1.15.3. Example: Data and Model Predictions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-predictions-with-uncertainty-bands">1.15.4. Example: Predictions with Uncertainty Bands</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-bar-charts-for-sensitivity-analysis">1.15.5. Example: Bar Charts for Sensitivity Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-colored-contour-plots">1.15.6. Example : Colored Contour Plots</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="preparing-publication-quality-figures-in-python">
<h1><span class="section-number">1.15. </span>Preparing Publication Quality Figures in Python<a class="headerlink" href="#preparing-publication-quality-figures-in-python" title="Link to this heading">#</a></h1>
<section id="learning-objectives">
<h2><span class="section-number">1.15.1. </span>Learning Objectives<a class="headerlink" href="#learning-objectives" title="Link to this heading">#</a></h2>
<p>After studying this notebook, completing the activities, and asking questions in class, you should be able to:</p>
<ul class="simple">
<li><p>Recognize features that make a scientific figure worthy of publication.</p></li>
<li><p>Understand how to add various features to scientific figures and be familiar with where to find syntax for reference.</p></li>
</ul>
</section>
<section id="what-makes-a-scientific-figure-look-great">
<h2><span class="section-number">1.15.2. </span>What makes a scientific figure look great?<a class="headerlink" href="#what-makes-a-scientific-figure-look-great" title="Link to this heading">#</a></h2>
<p><strong>Graphical Excellence</strong></p>
<p>The following short article describes what makes a great scientific data visualization:</p>
<p>P. Kamat, G. V. Hartland, and G. C. Schatz (2014). <a class="reference external" href="https://pubs.acs.org/doi/pdf/10.1021/jz500997e">Graphical Excellence</a>, <em>J. Phys. Chem. Lett.</em>, 5(12), 2118–2120.</p>
<p><img alt="image.png" src="https://ndcbe.github.io/data-and-computing/_images/publication-figure.png" /></p>
<p><strong>Python Format Recommandations</strong></p>
<p>Based on this paper, we developed the following guidelines to use with <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p>
<p>Figure</p>
<ul class="simple">
<li><p>Figure size: 4x4, 4x6.4</p></li>
<li><p>Dpi: 300</p></li>
</ul>
<p>Plot</p>
<ul class="simple">
<li><p>Line width: 3</p></li>
<li><p>Marker size: 8</p></li>
</ul>
<p>Axes</p>
<ul class="simple">
<li><p>Ticks font size: 15</p></li>
<li><p>Major ticks direction: in</p></li>
<li><p>Minor ticks direction: in</p></li>
</ul>
<p>Axis Label</p>
<ul class="simple">
<li><p>Font size: 16</p></li>
<li><p>Font weight: bold</p></li>
</ul>
<p>All of these examples (below) use these guidelines.</p>
<p><a class="reference external" href="https://thenode.biologists.com/data-visualization-with-flying-colors/research/">Color blind friendly palettes</a></p>
</section>
<section id="example-data-and-model-predictions">
<h2><span class="section-number">1.15.3. </span>Example: Data and Model Predictions<a class="headerlink" href="#example-data-and-model-predictions" title="Link to this heading">#</a></h2>
<p>In this first example prepared by <a class="reference external" href="https://github.com/lxhowl">Xinhong Liu</a>, we will create a plot in the graphical abstract from:</p>
<p>J. A. Ouimet, X. L., D. J. Brown, E. A. Eugene, T. Popps, Z. W. Muetzel, A. W. Dowling, W. A. Phillip (2022). <a class="reference external" href="https://doi.org/10.1016/j.memsci.2021.119743">DATA: Diafiltration Apparatus for high-Throughput Analysis</a>, <em>J. Membrane Science</em>, 641(1), p. 119743.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>
</pre></div>
</div>
</div>
</div>
<p>For simplicity, we “hard coded” the data into this notebook. In our actually research code, these data are generated automaically, stored in csv files, and read into Python with <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Experiment data stored in dict</span>
<span class="n">data_stru</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">630</span><span class="p">,</span> <span class="mi">715</span><span class="p">,</span> <span class="mi">1445</span><span class="p">,</span> <span class="mi">1480</span><span class="p">,</span> <span class="mi">1930</span><span class="p">,</span> <span class="mi">2395</span><span class="p">,</span> <span class="mi">2430</span><span class="p">,</span> <span class="mi">3330</span><span class="p">,</span> <span class="mi">3540</span><span class="p">,</span> <span class="mi">3665</span><span class="p">,</span> <span class="mi">4530</span><span class="p">,</span> <span class="mi">4875</span><span class="p">,</span> <span class="mi">5360</span><span class="p">,</span> <span class="mi">6280</span><span class="p">,</span> <span class="mi">6415</span><span class="p">,</span> <span class="mi">7085</span><span class="p">,</span> <span class="mi">7940</span><span class="p">,</span> <span class="mi">8240</span><span class="p">,</span> <span class="mi">9030</span><span class="p">,</span> <span class="mi">9930</span><span class="p">,</span> <span class="mi">10235</span><span class="p">,</span> <span class="mi">10930</span><span class="p">,</span> <span class="mi">11680</span><span class="p">,</span> <span class="mi">12280</span><span class="p">,</span> <span class="mi">12575</span><span class="p">,</span> <span class="mi">13230</span><span class="p">,</span> <span class="mi">15215</span><span class="p">],</span>
             <span class="s1">&#39;cF_exp&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">15.20517956</span><span class="p">,</span> <span class="mf">15.20517956</span><span class="p">,</span> <span class="mf">20.17925714</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">27.74228235</span><span class="p">,</span> <span class="mf">31.0364</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">34.73451321</span><span class="p">,</span> <span class="mf">42.10616744</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">41.21821818</span><span class="p">,</span> <span class="mf">49.70306667</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">53.94549091</span><span class="p">,</span> <span class="mf">55.5364</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">59.79315676</span><span class="p">,</span> <span class="mf">63.0364</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">66.67276364</span><span class="p">,</span> <span class="mf">68.6614</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">70.77833548</span><span class="p">,</span> <span class="mf">74.22284068</span><span class="p">,</span> <span class="mf">75.4501931</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">76.72061053</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> 
             <span class="s1">&#39;cV_avg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">2.371375951</span><span class="p">,</span> <span class="mf">2.971221924</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">3.608081644</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">4.863598959</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">6.184805962</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">7.398282511</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">8.986931928</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">11.26145154</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">12.20494634</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">16.70175135</span><span class="p">]}</span>

<span class="c1"># Model predictions stored in dict</span>
<span class="n">fit_stru</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">630</span><span class="p">,</span> <span class="mi">715</span><span class="p">,</span> <span class="mi">1445</span><span class="p">,</span> <span class="mi">1480</span><span class="p">,</span> <span class="mi">1930</span><span class="p">,</span> <span class="mi">2395</span><span class="p">,</span> <span class="mi">2430</span><span class="p">,</span> <span class="mi">3330</span><span class="p">,</span> <span class="mi">3540</span><span class="p">,</span> <span class="mi">3665</span><span class="p">,</span> <span class="mi">4530</span><span class="p">,</span> <span class="mi">4875</span><span class="p">,</span> <span class="mi">5360</span><span class="p">,</span> <span class="mi">6280</span><span class="p">,</span> <span class="mi">6415</span><span class="p">,</span> <span class="mi">7085</span><span class="p">,</span> <span class="mi">7940</span><span class="p">,</span> <span class="mi">8240</span><span class="p">,</span> <span class="mi">9030</span><span class="p">,</span> <span class="mi">9930</span><span class="p">,</span> <span class="mi">10235</span><span class="p">,</span> <span class="mi">10930</span><span class="p">,</span> <span class="mi">11680</span><span class="p">,</span> <span class="mi">12280</span><span class="p">,</span> <span class="mi">12575</span><span class="p">,</span> <span class="mi">13230</span><span class="p">,</span> <span class="mi">15215</span><span class="p">],</span>
            <span class="s1">&#39;cF&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">15.20517956</span><span class="p">,</span> <span class="mf">15.30581000885246</span><span class="p">,</span> <span class="mf">21.186911048158944</span><span class="p">,</span> <span class="mf">21.94776258720176</span><span class="p">,</span> <span class="mf">27.935712649713867</span><span class="p">,</span> <span class="mf">27.935712649713867</span><span class="p">,</span> <span class="mf">31.41957200691469</span><span class="p">,</span> <span class="mf">34.79231254607359</span><span class="p">,</span> <span class="mf">34.79231254607359</span><span class="p">,</span> <span class="mf">40.737212176615486</span><span class="p">,</span> <span class="mf">42.024440019753044</span><span class="p">,</span> <span class="mf">42.62511080503662</span><span class="p">,</span> <span class="mf">47.51297790337563</span><span class="p">,</span> <span class="mf">49.32034465832626</span><span class="p">,</span> <span class="mf">51.47034529371476</span><span class="p">,</span> <span class="mf">55.72406395078971</span><span class="p">,</span> <span class="mf">56.31185664451917</span><span class="p">,</span> <span class="mf">59.00364601757129</span><span class="p">,</span> <span class="mf">62.300546660870005</span><span class="p">,</span> <span class="mf">63.39102918275215</span><span class="p">,</span> <span class="mf">65.91456478110173</span><span class="p">,</span> <span class="mf">68.79648688113936</span><span class="p">,</span> <span class="mf">69.72116826647738</span><span class="p">,</span> <span class="mf">71.66837157084154</span><span class="p">,</span> <span class="mf">73.72202692048653</span><span class="p">,</span> <span class="mf">75.27787416192324</span><span class="p">,</span> <span class="mf">76.01654487095536</span><span class="p">,</span> <span class="mf">77.42158102079782</span><span class="p">,</span> <span class="mf">81.81060107249392</span><span class="p">],</span> 
            <span class="s1">&#39;cH&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.8971007608000001</span><span class="p">,</span> <span class="mf">1.857468593269977</span><span class="p">,</span> <span class="mf">1.7651071567700096</span><span class="p">,</span> <span class="mf">1.844767802680894</span><span class="p">,</span> <span class="mf">2.5666499819216466</span><span class="p">,</span> <span class="mf">2.5666499819216466</span><span class="p">,</span> <span class="mf">3.045470174932628</span><span class="p">,</span> <span class="mf">3.5529667541583545</span><span class="p">,</span> <span class="mf">3.5529667541583545</span><span class="p">,</span> <span class="mf">4.568847236522133</span><span class="p">,</span> <span class="mf">4.811750292853133</span><span class="p">,</span> <span class="mf">4.92814180996477</span><span class="p">,</span> <span class="mf">5.952827220990674</span><span class="p">,</span> <span class="mf">6.369556241211926</span><span class="p">,</span> <span class="mf">6.894439305225153</span><span class="p">,</span> <span class="mf">8.034207387259743</span><span class="p">,</span> <span class="mf">8.203010953189972</span><span class="p">,</span> <span class="mf">9.013552663552899</span><span class="p">,</span> <span class="mf">10.094858239741818</span><span class="p">,</span> <span class="mf">10.475147439508877</span><span class="p">,</span> <span class="mf">11.40039115341059</span><span class="p">,</span> <span class="mf">12.537180598977393</span><span class="p">,</span> <span class="mf">12.920607805042627</span><span class="p">,</span> <span class="mf">13.758398327314904</span><span class="p">,</span> <span class="mf">14.687274225493889</span><span class="p">,</span> <span class="mf">15.422320387044207</span><span class="p">,</span> <span class="mf">15.780811354585317</span><span class="p">,</span> <span class="mf">16.479645784135432</span><span class="p">,</span> <span class="mf">18.805287502530643</span><span class="p">]}</span>
</pre></div>
</div>
</div>
</div>
<p>We define a function to create the plot. The optional arguements are toggles to turn certain aspects of the figure on or off. Sometimes, we add extra information to the figure (e.g., title with timestamp of experiment ID) that is useful when organizing results. But for a final publication, we want to remove that aspect of the figure. These toggles make sure customization easy (and clean).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_sim_comparison</span><span class="p">(</span><span class="n">data_stru</span><span class="p">,</span><span class="n">fit_stru</span><span class="p">,</span><span class="n">plot_pred</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">lg</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot simulation results comparing model predictions (lines) and data </span>
<span class="sd">    (symbols) with box annotations</span>

<span class="sd">    Arguments:</span>
<span class="sd">        data_stru: dictionary containing &quot;time&quot;, &quot;cF_exp&quot;, and &quot;cV_avg&quot; keys with</span>
<span class="sd">            lists of floats as values</span>
<span class="sd">        fit_stru: dictionary containing &quot;time&quot;, &quot;cF&quot;, and &quot;cH&quot; keys with lists</span>
<span class="sd">            as floats as values</span>
<span class="sd">        plot_pred: boolean. If true, plot the prediction</span>
<span class="sd">        lg: boolean. If true, add the legend</span>

<span class="sd">    Returns:</span>
<span class="sd">        nothing </span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    
    <span class="c1"># plot ghost points for legend</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="s1">&#39;ms&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Retentate (Measurement)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot_pred</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Retentate (Prediction)&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="s1">&#39;cs&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Vial (Measurement)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot_pred</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Permeate (Prediction)&#39;</span><span class="p">)</span>

    <span class="c1"># add errorbars (arbitrary for this example)</span>
    <span class="n">cV_avg_err</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.25</span><span class="o">*</span><span class="n">cv</span> <span class="k">for</span> <span class="n">cv</span> <span class="ow">in</span> <span class="n">data_stru</span><span class="p">[</span><span class="s1">&#39;cV_avg&#39;</span><span class="p">]]</span> <span class="c1"># 25 %</span>
    <span class="n">cF_exp_err</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="o">*</span><span class="n">cf</span> <span class="k">for</span> <span class="n">cf</span> <span class="ow">in</span> <span class="n">data_stru</span><span class="p">[</span><span class="s1">&#39;cF_exp&#39;</span><span class="p">]]</span> <span class="c1"># 5 %</span>

    <span class="c1"># plot concentration data (with errorbars)/prediction comparison</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">([</span><span class="n">t</span><span class="o">/</span><span class="mi">60</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">data_stru</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]],</span> <span class="n">data_stru</span><span class="p">[</span><span class="s1">&#39;cV_avg&#39;</span><span class="p">],</span> 
                 <span class="n">yerr</span> <span class="o">=</span> <span class="n">cV_avg_err</span><span class="p">,</span>
                 <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="c1"># marker settings</span>
                 <span class="n">ecolor</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">elinewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">([</span><span class="n">t</span><span class="o">/</span><span class="mi">60</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">data_stru</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]],</span> <span class="n">data_stru</span><span class="p">[</span><span class="s1">&#39;cF_exp&#39;</span><span class="p">],</span> 
                 <span class="n">yerr</span> <span class="o">=</span> <span class="n">cF_exp_err</span><span class="p">,</span>
                 <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># marker settings</span>
                 <span class="n">ecolor</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">elinewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># code for plotting without error bars</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plt.plot([t/60 for t in data_stru[&#39;time&#39;]], </span>
<span class="sd">             data_stru[&#39;cV_avg&#39;], &#39;cs&#39;,markersize=8)</span>
<span class="sd">    plt.plot([t/60 for t in data_stru[&#39;time&#39;]],</span>
<span class="sd">              data_stru[&#39;cF_exp&#39;],&#39;ms&#39;,markersize=8,clip_on=False)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">plot_pred</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">t</span><span class="o">/</span><span class="mi">60</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">fit_stru</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]],</span>
                  <span class="n">fit_stru</span><span class="p">[</span><span class="s1">&#39;cF&#39;</span><span class="p">],</span>
                  <span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.6</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">t</span><span class="o">/</span><span class="mi">60</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">fit_stru</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]],</span>
                  <span class="n">fit_stru</span><span class="p">[</span><span class="s1">&#39;cH&#39;</span><span class="p">],</span>
                  <span class="s1">&#39;r-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.6</span><span class="p">)</span>

    <span class="c1"># add annotation</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Retentate&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">((</span><span class="n">fit_stru</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="mi">15</span><span class="p">])</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span>
                 <span class="n">fit_stru</span><span class="p">[</span><span class="s1">&#39;cF&#39;</span><span class="p">][</span><span class="mi">15</span><span class="p">]),</span>  <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                 <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
                 <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                 <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">),</span>
                 <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;wedge,tail_width=0.3&quot;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Permeate&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">((</span><span class="n">data_stru</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="mi">22</span><span class="p">])</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span>
             <span class="n">data_stru</span><span class="p">[</span><span class="s1">&#39;cV_avg&#39;</span><span class="p">][</span><span class="mi">22</span><span class="p">]),</span>  <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                 <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
                 <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                 <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">),</span>
                 <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;wedge,tail_width=0.3&quot;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [min]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration [mM]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="c1">#plt.xticks(fontsize=15,rotation=45) # rotate ticks (optional)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># This commented out code turns on minor ticks</span>
    <span class="c1">#plt.minorticks_on() # turn on minor ticks</span>
    <span class="c1">#plt.tick_params(which=&quot;minor&quot;,direction=&quot;in&quot;,top=True, right=True)</span>
    <span class="c1">#plt.gca().axes.xaxis.set_ticklabels([]) # remove tick labels</span>
    <span class="c1">#plt.gca().axes.yaxis.set_ticklabels([])</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># invisible overlaped ticks</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">xticks</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">()</span>
    <span class="n">xticks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label1</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">lg</span><span class="p">:</span>
        <span class="c1"># Add legend</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.02</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span><span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Save to file (for including in manuscript)</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;concentration&#39;</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_sim_comparison</span><span class="p">(</span><span class="n">data_stru</span><span class="p">,</span><span class="n">fit_stru</span><span class="p">,</span><span class="n">plot_pred</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">lg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ebrea\anaconda3\envs\jbook\lib\site-packages\numpy\core\_methods.py:44: RuntimeWarning: invalid value encountered in reduce
  return umr_minimum(a, axis, None, out, keepdims, initial, where)
C:\Users\ebrea\anaconda3\envs\jbook\lib\site-packages\numpy\core\_methods.py:40: RuntimeWarning: invalid value encountered in reduce
  return umr_maximum(a, axis, None, out, keepdims, initial, where)
</pre></div>
</div>
<img alt="../../_images/61220a0bafeaa54c3cbae87a203ee0934ba0bd9da25c754efa4b34ff91d72b1a.png" src="../../_images/61220a0bafeaa54c3cbae87a203ee0934ba0bd9da25c754efa4b34ff91d72b1a.png" />
</div>
</div>
</section>
<section id="example-predictions-with-uncertainty-bands">
<h2><span class="section-number">1.15.4. </span>Example: Predictions with Uncertainty Bands<a class="headerlink" href="#example-predictions-with-uncertainty-bands" title="Link to this heading">#</a></h2>
<p>In this next example, prepared by <a class="reference external" href="https://github.com/kylajones">Kyla Jones</a>, we will plot (synthetic) observed data, model predictions, and prediction uncertainty bands.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">FormatStrFormatter</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Patch</span>
<span class="kn">from</span> <span class="nn">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>
</pre></div>
</div>
</div>
</div>
<p>For simplicity, we define all of the data in this notebook. In actuality, involved calculations we performed to obtain the model predictions and uncertainty estimates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Hardcode all data</span>

<span class="c1">## y observed</span>

<span class="n">Nobs</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">Ntemp</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">empty_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">Ntemp</span><span class="p">,</span> <span class="n">Nobs</span><span class="p">])</span>

<span class="c1"># species A</span>
<span class="n">y_a</span> <span class="o">=</span> <span class="n">empty_obs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y_a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.02344425</span><span class="p">,</span> <span class="mf">1.36860251</span><span class="p">,</span> <span class="mf">1.03096299</span><span class="p">,</span> <span class="mf">0.65740269</span><span class="p">,</span> <span class="mf">0.57241884</span><span class="p">,</span> <span class="mf">0.34985885</span><span class="p">,</span> <span class="mf">0.33058912</span><span class="p">,</span> <span class="mf">0.1681872</span><span class="p">,</span>  <span class="mf">0.21952612</span><span class="p">,</span> <span class="mf">0.09226589</span><span class="p">,</span> <span class="mf">0.04931872</span><span class="p">])</span>
<span class="n">y_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.02586019</span><span class="p">,</span> <span class="mf">1.08716909</span><span class="p">,</span> <span class="mf">0.68781963</span><span class="p">,</span> <span class="mf">0.39403194</span><span class="p">,</span> <span class="mf">0.16032257</span><span class="p">,</span> <span class="mf">0.23428204</span><span class="p">,</span> <span class="mf">0.02076534</span><span class="p">,</span> <span class="mf">0.04033475</span><span class="p">,</span> <span class="mf">0.0978981</span><span class="p">,</span> <span class="mf">0.07540423</span><span class="p">,</span> <span class="mf">0.07714833</span><span class="p">])</span>
<span class="n">y_a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.06153694</span><span class="p">,</span> <span class="mf">0.79796719</span><span class="p">,</span> <span class="mf">0.36428256</span><span class="p">,</span> <span class="mf">0.28103432</span><span class="p">,</span> <span class="mf">0.15975079</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.02254134</span><span class="p">,</span> <span class="mf">0.07891708</span><span class="p">,</span> <span class="mf">0.10685296</span><span class="p">,</span> <span class="mf">0.12181174</span><span class="p">,</span> <span class="mf">0.02014969</span><span class="p">,</span> <span class="mf">0.05518219</span><span class="p">])</span>
<span class="n">y_a</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.91735135</span><span class="p">,</span> <span class="mf">0.55511856</span><span class="p">,</span> <span class="mf">0.23183268</span><span class="p">,</span> <span class="mf">0.17951325</span><span class="p">,</span> <span class="mf">0.10104957</span><span class="p">,</span> <span class="mf">0.07111516</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.06139098</span><span class="p">,</span>  <span class="mf">0.02229231</span><span class="p">,</span>  <span class="mf">0.11901155</span><span class="p">,</span>  <span class="mf">0.05373958</span><span class="p">,</span>  <span class="mf">0.06958662</span><span class="p">])</span>

<span class="c1"># species B</span>
<span class="n">y_b</span> <span class="o">=</span> <span class="n">empty_obs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.03752427</span><span class="p">,</span> <span class="mf">0.60530102</span><span class="p">,</span> <span class="mf">0.9955825</span><span class="p">,</span> <span class="mf">1.37850256</span><span class="p">,</span> <span class="mf">1.46935982</span><span class="p">,</span> <span class="mf">1.66645002</span><span class="p">,</span> <span class="mf">1.66070452</span><span class="p">,</span> <span class="mf">1.76850223</span><span class="p">,</span> <span class="mf">1.77915875</span><span class="p">,</span> <span class="mf">1.76184489</span><span class="p">,</span> <span class="mf">1.81672473</span><span class="p">])</span>
<span class="n">y_b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.01296338</span><span class="p">,</span> <span class="mf">0.89639214</span><span class="p">,</span> <span class="mf">1.39186189</span><span class="p">,</span> <span class="mf">1.57595299</span><span class="p">,</span> <span class="mf">1.73540578</span><span class="p">,</span> <span class="mf">1.69419998</span><span class="p">,</span> <span class="mf">1.5826509</span><span class="p">,</span>  <span class="mf">1.60318491</span><span class="p">,</span> <span class="mf">1.66460086</span><span class="p">,</span> <span class="mf">1.51776157</span><span class="p">,</span> <span class="mf">1.58146774</span><span class="p">])</span>
<span class="n">y_b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.02792897</span><span class="p">,</span> <span class="mf">1.13569095</span><span class="p">,</span> <span class="mf">1.57844183</span><span class="p">,</span> <span class="mf">1.67418324</span><span class="p">,</span> <span class="mf">1.5395483</span><span class="p">,</span> <span class="mf">1.54537824</span><span class="p">,</span> <span class="mf">1.44573124</span><span class="p">,</span> <span class="mf">1.38463391</span><span class="p">,</span> <span class="mf">1.35080703</span><span class="p">,</span> <span class="mf">1.28076757</span><span class="p">,</span> <span class="mf">1.25975991</span><span class="p">])</span>
<span class="n">y_b</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0379667</span><span class="p">,</span> <span class="mf">1.39594316</span><span class="p">,</span> <span class="mf">1.59870984</span><span class="p">,</span> <span class="mf">1.50034396</span><span class="p">,</span> <span class="mf">1.31129013</span><span class="p">,</span> <span class="mf">1.27005324</span><span class="p">,</span> <span class="mf">1.18085389</span><span class="p">,</span> <span class="mf">1.13550051</span><span class="p">,</span> <span class="mf">0.96852283</span><span class="p">,</span> <span class="mf">1.02524932</span><span class="p">,</span> <span class="mf">0.98662983</span><span class="p">])</span>

<span class="c1"># species C</span>
<span class="n">y_c</span> <span class="o">=</span> <span class="n">empty_obs</span>
<span class="n">y_c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.01385988</span><span class="p">,</span> <span class="mf">0.07233084</span><span class="p">,</span> <span class="mf">0.0138011</span><span class="p">,</span> <span class="mf">0.04580091</span><span class="p">,</span> <span class="mf">0.01139069</span><span class="p">,</span> <span class="mf">0.00281789</span><span class="p">,</span> <span class="mf">0.04759571</span><span class="p">,</span> <span class="mf">0.03531502</span><span class="p">,</span> <span class="mf">0.10974563</span><span class="p">,</span> <span class="mf">0.14194261</span><span class="p">,</span> <span class="mf">0.12514075</span><span class="p">])</span>
<span class="n">y_c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.07376425</span><span class="p">,</span> <span class="mf">0.0243219</span><span class="p">,</span> <span class="mf">0.00364111</span><span class="p">,</span> <span class="mf">0.05713541</span><span class="p">,</span> <span class="mf">0.08313851</span><span class="p">,</span> <span class="mf">0.18909311</span><span class="p">,</span> <span class="mf">0.23693068</span><span class="p">,</span> <span class="mf">0.26420506</span><span class="p">,</span> <span class="mf">0.3413782</span><span class="p">,</span> <span class="mf">0.32597304</span><span class="p">,</span> <span class="mf">0.27979896</span><span class="p">])</span>
<span class="n">y_c</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.00943458</span><span class="p">,</span> <span class="mf">0.01096848</span><span class="p">,</span> <span class="mf">0.06149562</span><span class="p">,</span> <span class="mf">0.18328175</span><span class="p">,</span> <span class="mf">0.285206</span><span class="p">,</span> <span class="mf">0.38444738</span><span class="p">,</span> <span class="mf">0.52486223</span><span class="p">,</span> <span class="mf">0.55009396</span><span class="p">,</span> <span class="mf">0.51287361</span><span class="p">,</span> <span class="mf">0.65236054</span><span class="p">,</span> <span class="mf">0.72341975</span><span class="p">])</span>
<span class="n">y_c</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.01221299</span><span class="p">,</span> <span class="mf">0.07851271</span><span class="p">,</span> <span class="mf">0.24902781</span><span class="p">,</span> <span class="mf">0.44011205</span><span class="p">,</span> <span class="mf">0.54449372</span><span class="p">,</span> <span class="mf">0.68277854</span><span class="p">,</span> <span class="mf">0.74685861</span><span class="p">,</span> <span class="mf">0.78954617</span><span class="p">,</span> <span class="mf">0.85525827</span><span class="p">,</span> <span class="mf">0.92077101</span><span class="p">,</span> <span class="mf">0.98371899</span><span class="p">])</span>

<span class="c1">## y predicted</span>

<span class="n">Npred</span> <span class="o">=</span> <span class="mi">21</span>

<span class="n">empty_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">Ntemp</span><span class="p">,</span> <span class="n">Npred</span><span class="p">])</span>

<span class="c1"># species A</span>
<span class="n">y_a_star</span> <span class="o">=</span> <span class="n">empty_pred</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y_a_star</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.59768464</span><span class="p">,</span> <span class="mf">1.2762981</span><span class="p">,</span> <span class="mf">1.01956093</span><span class="p">,</span> <span class="mf">0.81446842</span><span class="p">,</span> <span class="mf">0.65063184</span><span class="p">,</span> <span class="mf">0.51975225</span><span class="p">,</span> <span class="mf">0.41520009</span><span class="p">,</span> <span class="mf">0.3316794</span><span class="p">,</span> <span class="mf">0.26495954</span><span class="p">,</span> <span class="mf">0.21166089</span><span class="p">,</span> 
                        <span class="mf">0.16908368</span><span class="p">,</span> <span class="mf">0.1350712</span><span class="p">,</span> <span class="mf">0.10790059</span><span class="p">,</span> <span class="mf">0.08619556</span><span class="p">,</span> <span class="mf">0.06885666</span><span class="p">,</span> <span class="mf">0.05500561</span><span class="p">,</span> <span class="mf">0.04394081</span><span class="p">,</span> <span class="mf">0.03510178</span><span class="p">,</span> <span class="mf">0.02804079</span><span class="p">,</span> <span class="mf">0.02240017</span><span class="p">])</span>
<span class="n">y_a_star</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.43192894</span><span class="p">,</span> <span class="mf">1.02521025</span><span class="p">,</span> <span class="mf">0.73401411</span><span class="p">,</span> <span class="mf">0.52552803</span><span class="p">,</span> <span class="mf">0.3762594</span><span class="p">,</span> <span class="mf">0.26938836</span><span class="p">,</span> <span class="mf">0.1928725</span><span class="p">,</span> <span class="mf">0.13808985</span><span class="p">,</span> <span class="mf">0.09886743</span><span class="p">,</span> <span class="mf">0.07078557</span><span class="p">,</span> 
                         <span class="mf">0.05067995</span><span class="p">,</span> <span class="mf">0.03628504</span><span class="p">,</span> <span class="mf">0.0259788</span><span class="p">,</span> <span class="mf">0.0185999</span><span class="p">,</span> <span class="mf">0.01331687</span><span class="p">,</span> <span class="mf">0.0095344</span><span class="p">,</span> <span class="mf">0.00682629</span><span class="p">,</span> <span class="mf">0.00488738</span><span class="p">,</span> <span class="mf">0.00349919</span><span class="p">,</span> <span class="mf">0.0025053</span><span class="p">])</span>
<span class="n">y_a_star</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.00000000e+00</span><span class="p">,</span> <span class="mf">1.27514755e+00</span><span class="p">,</span> <span class="mf">8.13000633e-01</span><span class="p">,</span> <span class="mf">5.18347881e-01</span><span class="p">,</span> <span class="mf">3.30485014e-01</span><span class="p">,</span> <span class="mf">2.10708578e-01</span><span class="p">,</span> <span class="mf">1.34342263e-01</span><span class="p">,</span> <span class="mf">8.56531035e-02</span><span class="p">,</span>
                        <span class="mf">5.46101724e-02</span><span class="p">,</span> <span class="mf">3.48180137e-02</span><span class="p">,</span> <span class="mf">2.21990524e-02</span><span class="p">,</span> <span class="mf">1.41535336e-02</span><span class="p">,</span> <span class="mf">9.02392180e-03</span><span class="p">,</span> <span class="mf">5.75341587e-03</span><span class="p">,</span> <span class="mf">3.66822707e-03</span><span class="p">,</span> <span class="mf">2.33876537e-03</span><span class="p">,</span>
                        <span class="mf">1.49113546e-03</span><span class="p">,</span> <span class="mf">9.50708864e-04</span><span class="p">,</span> <span class="mf">6.06147038e-04</span><span class="p">,</span> <span class="mf">3.86463454e-04</span><span class="p">,</span> <span class="mf">2.46398963e-04</span><span class="p">])</span>
<span class="n">y_a_star</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.00000000e+00</span><span class="p">,</span> <span class="mf">1.13393738e+00</span><span class="p">,</span> <span class="mf">6.42906988e-01</span><span class="p">,</span> <span class="mf">3.64508132e-01</span><span class="p">,</span> <span class="mf">2.06664698e-01</span><span class="p">,</span> <span class="mf">1.17172413e-01</span><span class="p">,</span> <span class="mf">6.64330892e-02</span><span class="p">,</span> <span class="mf">3.76654815e-02</span><span class="p">,</span>
                        <span class="mf">2.13551486e-02</span><span class="p">,</span> <span class="mf">1.21077006e-02</span><span class="p">,</span> <span class="mf">6.86468715e-03</span><span class="p">,</span> <span class="mf">3.89206267e-03</span><span class="p">,</span> <span class="mf">2.20667767e-03</span><span class="p">,</span> <span class="mf">1.25111715e-03</span><span class="p">,</span> <span class="mf">7.09344247e-04</span><span class="p">,</span> <span class="mf">4.02175978e-04</span><span class="p">,</span>
                        <span class="mf">2.28021187e-04</span><span class="p">,</span> <span class="mf">1.29280873e-04</span><span class="p">,</span> <span class="mf">7.32982072e-05</span><span class="p">,</span> <span class="mf">4.15577884e-05</span><span class="p">,</span> <span class="mf">2.35619648e-05</span><span class="p">])</span>

<span class="c1"># species B</span>
<span class="n">y_b_star</span> <span class="o">=</span> <span class="n">empty_pred</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">y_b_star</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.03270519</span><span class="p">,</span> <span class="mf">0.39926139</span><span class="p">,</span> <span class="mf">0.68731271</span><span class="p">,</span> <span class="mf">0.9354765</span><span class="p">,</span> <span class="mf">1.15467428</span><span class="p">,</span> <span class="mf">1.33761972</span><span class="p">,</span> <span class="mf">1.47392424</span><span class="p">,</span> <span class="mf">1.56736103</span><span class="p">,</span> <span class="mf">1.64477813</span><span class="p">,</span> <span class="mf">1.72322029</span><span class="p">,</span> <span class="mf">1.78283252</span><span class="p">,</span> 
                        <span class="mf">1.80362121</span><span class="p">,</span> <span class="mf">1.80259763</span><span class="p">,</span> <span class="mf">1.80761942</span><span class="p">,</span> <span class="mf">1.82500871</span><span class="p">,</span> <span class="mf">1.84425379</span><span class="p">,</span> <span class="mf">1.85162638</span><span class="p">,</span> <span class="mf">1.84487036</span><span class="p">,</span> <span class="mf">1.84124298</span><span class="p">,</span> <span class="mf">1.85587223</span><span class="p">,</span> <span class="mf">1.88118926</span><span class="p">])</span>
<span class="n">y_b_star</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.01671025</span><span class="p">,</span> <span class="mf">0.55383436</span><span class="p">,</span> <span class="mf">0.91650889</span><span class="p">,</span> <span class="mf">1.17570006</span><span class="p">,</span> <span class="mf">1.36693187</span><span class="p">,</span> <span class="mf">1.5015587</span><span class="p">,</span> <span class="mf">1.5820901</span><span class="p">,</span> <span class="mf">1.62015396</span><span class="p">,</span> <span class="mf">1.64645615</span><span class="p">,</span> <span class="mf">1.67929046</span><span class="p">,</span> <span class="mf">1.69878894</span><span class="p">,</span>
                         <span class="mf">1.68435974</span><span class="p">,</span> <span class="mf">1.65219138</span><span class="p">,</span> <span class="mf">1.629514</span><span class="p">,</span> <span class="mf">1.62213033</span><span class="p">,</span> <span class="mf">1.6187281</span><span class="p">,</span> <span class="mf">1.60468673</span><span class="p">,</span> <span class="mf">1.57720045</span><span class="p">,</span> <span class="mf">1.55336206</span><span class="p">,</span> <span class="mf">1.54843504</span><span class="p">,</span> <span class="mf">1.55513168</span><span class="p">])</span>
<span class="n">y_b_star</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.00610998</span><span class="p">,</span> <span class="mf">0.70773819</span><span class="p">,</span> <span class="mf">1.11833386</span><span class="p">,</span> <span class="mf">1.3416306</span><span class="p">,</span> <span class="mf">1.4524385</span><span class="p">,</span> <span class="mf">1.49667326</span><span class="p">,</span> <span class="mf">1.50216811</span><span class="p">,</span> <span class="mf">1.48843442</span><span class="p">,</span> <span class="mf">1.4704685</span><span class="p">,</span> <span class="mf">1.45434913</span><span class="p">,</span> <span class="mf">1.43575602</span><span class="p">,</span>
                        <span class="mf">1.40975002</span><span class="p">,</span> <span class="mf">1.37968974</span><span class="p">,</span> <span class="mf">1.3530836</span><span class="p">,</span> <span class="mf">1.3326319</span><span class="p">,</span> <span class="mf">1.31447336</span><span class="p">,</span> <span class="mf">1.29341394</span><span class="p">,</span> <span class="mf">1.2690736</span><span class="p">,</span> <span class="mf">1.24668352</span><span class="p">,</span> <span class="mf">1.23083234</span><span class="p">,</span> <span class="mf">1.21997388</span><span class="p">])</span>
<span class="n">y_b_star</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.03278059</span><span class="p">,</span> <span class="mf">0.82392828</span><span class="p">,</span> <span class="mf">1.23715807</span><span class="p">,</span> <span class="mf">1.40009353</span><span class="p">,</span> <span class="mf">1.42839638</span><span class="p">,</span> <span class="mf">1.39244126</span><span class="p">,</span> <span class="mf">1.33332529</span><span class="p">,</span> <span class="mf">1.2726671</span><span class="p">,</span>  <span class="mf">1.21982743</span><span class="p">,</span> <span class="mf">1.17694373</span><span class="p">,</span> 
                        <span class="mf">1.14258333</span><span class="p">,</span> <span class="mf">1.11470584</span><span class="p">,</span> <span class="mf">1.0921472</span><span class="p">,</span> <span class="mf">1.07408545</span><span class="p">,</span> <span class="mf">1.05895914</span><span class="p">,</span> <span class="mf">1.04463014</span><span class="p">,</span> <span class="mf">1.02965292</span><span class="p">,</span> <span class="mf">1.01413203</span><span class="p">,</span> <span class="mf">0.99917604</span><span class="p">,</span> <span class="mf">0.98542831</span><span class="p">,</span> <span class="mf">0.97209606</span><span class="p">])</span>

<span class="c1"># species C</span>
<span class="n">y_c_star</span> <span class="o">=</span> <span class="n">empty_pred</span>
<span class="n">y_c_star</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.03270519</span><span class="p">,</span> <span class="mf">0.00305397</span><span class="p">,</span> <span class="mf">0.03638919</span><span class="p">,</span> <span class="mf">0.04496257</span><span class="p">,</span> <span class="mf">0.0308573</span><span class="p">,</span> <span class="mf">0.01174844</span><span class="p">,</span> <span class="mf">0.00632351</span><span class="p">,</span> <span class="mf">0.01743888</span><span class="p">,</span> <span class="mf">0.02354247</span><span class="p">,</span> <span class="mf">0.01182017</span><span class="p">,</span> 
                        <span class="mf">0.00550658</span><span class="p">,</span> <span class="mf">0.02729511</span><span class="p">,</span> <span class="mf">0.06233117</span><span class="p">,</span> <span class="mf">0.08447999</span><span class="p">,</span> <span class="mf">0.08879573</span><span class="p">,</span> <span class="mf">0.08688955</span><span class="p">,</span> <span class="mf">0.09336801</span><span class="p">,</span> <span class="mf">0.11118882</span><span class="p">,</span> <span class="mf">0.12365524</span><span class="p">,</span> <span class="mf">0.11608698</span><span class="p">,</span> <span class="mf">0.09641057</span><span class="p">])</span>
<span class="n">y_c_star</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.01671025</span><span class="p">,</span> <span class="mf">0.0142367</span><span class="p">,</span> <span class="mf">0.05828086</span><span class="p">,</span> <span class="mf">0.09028582</span><span class="p">,</span> <span class="mf">0.10754011</span><span class="p">,</span> <span class="mf">0.12218191</span><span class="p">,</span> <span class="mf">0.14852154</span><span class="p">,</span> <span class="mf">0.18697355</span><span class="p">,</span> <span class="mf">0.21545399</span><span class="p">,</span> <span class="mf">0.22184211</span><span class="p">,</span> <span class="mf">0.2304255</span><span class="p">,</span>
                        <span class="mf">0.26496031</span><span class="p">,</span> <span class="mf">0.31152357</span><span class="p">,</span> <span class="mf">0.3445072</span><span class="p">,</span> <span class="mf">0.35926977</span><span class="p">,</span> <span class="mf">0.36795504</span><span class="p">,</span> <span class="mf">0.38577887</span><span class="p">,</span> <span class="mf">0.41597325</span><span class="p">,</span> <span class="mf">0.44175055</span><span class="p">,</span> <span class="mf">0.44806577</span><span class="p">,</span> <span class="mf">0.44236302</span><span class="p">])</span>
<span class="n">y_c_star</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.00610998</span><span class="p">,</span> <span class="mf">0.01711426</span><span class="p">,</span> <span class="mf">0.0686655</span><span class="p">,</span>  <span class="mf">0.14002152</span><span class="p">,</span> <span class="mf">0.21707649</span><span class="p">,</span> <span class="mf">0.29261817</span><span class="p">,</span> <span class="mf">0.36348962</span><span class="p">,</span> <span class="mf">0.42591248</span><span class="p">,</span> <span class="mf">0.47492132</span><span class="p">,</span> <span class="mf">0.51083286</span><span class="p">,</span> <span class="mf">0.54204493</span><span class="p">,</span> 
                        <span class="mf">0.57609645</span><span class="p">,</span> <span class="mf">0.61128634</span><span class="p">,</span> <span class="mf">0.64116298</span><span class="p">,</span> <span class="mf">0.66369988</span><span class="p">,</span> <span class="mf">0.68318787</span><span class="p">,</span> <span class="mf">0.70509493</span><span class="p">,</span> <span class="mf">0.72997569</span><span class="p">,</span> <span class="mf">0.75271033</span><span class="p">,</span> <span class="mf">0.76878119</span><span class="p">,</span> <span class="mf">0.77977973</span><span class="p">])</span>
<span class="n">y_c_star</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.03278059</span><span class="p">,</span> <span class="mf">0.04213434</span><span class="p">,</span> <span class="mf">0.11993494</span><span class="p">,</span> <span class="mf">0.23539834</span><span class="p">,</span> <span class="mf">0.36493892</span><span class="p">,</span> <span class="mf">0.49038633</span><span class="p">,</span> <span class="mf">0.60024162</span><span class="p">,</span> <span class="mf">0.68966742</span><span class="p">,</span> <span class="mf">0.75881742</span><span class="p">,</span> <span class="mf">0.81094857</span><span class="p">,</span> 
                        <span class="mf">0.85055198</span><span class="p">,</span> <span class="mf">0.88140209</span><span class="p">,</span> <span class="mf">0.90564613</span><span class="p">,</span> <span class="mf">0.92466343</span><span class="p">,</span> <span class="mf">0.94033152</span><span class="p">,</span> <span class="mf">0.95496768</span><span class="p">,</span> <span class="mf">0.97011906</span><span class="p">,</span> <span class="mf">0.98573869</span><span class="p">,</span> <span class="mf">1.00075066</span><span class="p">,</span> <span class="mf">1.01453013</span><span class="p">,</span> <span class="mf">1.02788038</span><span class="p">])</span>

<span class="c1">## variance of predictions</span>

<span class="c1"># species A</span>
<span class="n">var_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.05719945</span><span class="p">,</span> <span class="mf">0.06328314</span><span class="p">,</span> <span class="mf">0.07272865</span><span class="p">,</span> <span class="mf">0.07949682</span><span class="p">,</span> <span class="mf">0.08249553</span><span class="p">,</span> <span class="mf">0.08242237</span><span class="p">,</span> <span class="mf">0.08037767</span><span class="p">,</span> <span class="mf">0.07733186</span><span class="p">,</span> <span class="mf">0.07397983</span><span class="p">,</span> <span class="mf">0.07075224</span><span class="p">,</span> <span class="mf">0.06787686</span><span class="p">,</span>
                   <span class="mf">0.06544412</span><span class="p">,</span> <span class="mf">0.06346087</span><span class="p">,</span> <span class="mf">0.06188887</span><span class="p">,</span> <span class="mf">0.0606701</span><span class="p">,</span> <span class="mf">0.05974194</span><span class="p">,</span> <span class="mf">0.05904548</span><span class="p">,</span> <span class="mf">0.05852935</span><span class="p">,</span> <span class="mf">0.0581509</span><span class="p">,</span> <span class="mf">0.05787595</span><span class="p">,</span> <span class="mf">0.0576778</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.05719945</span><span class="p">,</span> <span class="mf">0.05976117</span><span class="p">,</span> <span class="mf">0.06245206</span><span class="p">,</span> <span class="mf">0.06325761</span><span class="p">,</span> <span class="mf">0.06272024</span><span class="p">,</span> <span class="mf">0.0616213</span><span class="p">,</span> <span class="mf">0.06046344</span><span class="p">,</span> <span class="mf">0.05947678</span><span class="p">,</span> <span class="mf">0.05872418</span><span class="p">,</span> <span class="mf">0.05818864</span><span class="p">,</span> <span class="mf">0.05782545</span><span class="p">,</span>
                    <span class="mf">0.05758773</span><span class="p">,</span> <span class="mf">0.05743631</span><span class="p">,</span> <span class="mf">0.05734195</span><span class="p">,</span> <span class="mf">0.05728416</span><span class="p">,</span> <span class="mf">0.0572493</span><span class="p">,</span> <span class="mf">0.05722852</span><span class="p">,</span> <span class="mf">0.05721627</span><span class="p">,</span> <span class="mf">0.05720911</span><span class="p">,</span> <span class="mf">0.05720497</span><span class="p">,</span> <span class="mf">0.05720258</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.05719945</span><span class="p">,</span> <span class="mf">0.06055497</span><span class="p">,</span> <span class="mf">0.06265554</span><span class="p">,</span> <span class="mf">0.06218973</span><span class="p">,</span> <span class="mf">0.06080576</span><span class="p">,</span> <span class="mf">0.05949002</span><span class="p">,</span> <span class="mf">0.05854026</span><span class="p">,</span> <span class="mf">0.05794131</span><span class="p">,</span> <span class="mf">0.05759333</span><span class="p">,</span> <span class="mf">0.05740209</span><span class="p">,</span> <span class="mf">0.05730114</span><span class="p">,</span>
                    <span class="mf">0.05724947</span><span class="p">,</span> <span class="mf">0.05722364</span><span class="p">,</span> <span class="mf">0.05721099</span><span class="p">,</span> <span class="mf">0.05720489</span><span class="p">,</span> <span class="mf">0.05720199</span><span class="p">,</span> <span class="mf">0.05720062</span><span class="p">,</span> <span class="mf">0.05719998</span><span class="p">,</span> <span class="mf">0.05719969</span><span class="p">,</span> <span class="mf">0.05719956</span><span class="p">,</span> <span class="mf">0.0571995</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.05719945</span><span class="p">,</span> <span class="mf">0.06748288</span><span class="p">,</span> <span class="mf">0.07042203</span><span class="p">,</span> <span class="mf">0.06676295</span><span class="p">,</span> <span class="mf">0.06266473</span><span class="p">,</span> <span class="mf">0.0599445</span><span class="p">,</span> <span class="mf">0.05847011</span><span class="p">,</span> <span class="mf">0.0577554</span><span class="p">,</span> <span class="mf">0.05743287</span><span class="p">,</span> <span class="mf">0.05729441</span><span class="p">,</span> <span class="mf">0.05723713</span><span class="p">,</span> 
                   <span class="mf">0.0572141</span><span class="p">,</span> <span class="mf">0.05720505</span><span class="p">,</span> <span class="mf">0.05720156</span><span class="p">,</span> <span class="mf">0.05720023</span><span class="p">,</span> <span class="mf">0.05719974</span><span class="p">,</span> <span class="mf">0.05719955</span><span class="p">,</span> <span class="mf">0.05719948</span><span class="p">,</span> <span class="mf">0.05719946</span><span class="p">,</span> <span class="mf">0.05719945</span><span class="p">,</span> <span class="mf">0.05719945</span><span class="p">]])</span>

<span class="c1"># species B</span>
<span class="n">var_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.08041407</span><span class="p">,</span> <span class="mf">0.08548342</span><span class="p">,</span> <span class="mf">0.0942853</span><span class="p">,</span> <span class="mf">0.10031488</span><span class="p">,</span> <span class="mf">0.10237395</span><span class="p">,</span> <span class="mf">0.10161885</span><span class="p">,</span> <span class="mf">0.09899488</span><span class="p">,</span> <span class="mf">0.09577745</span><span class="p">,</span> <span class="mf">0.09238062</span><span class="p">,</span> <span class="mf">0.08946731</span><span class="p">,</span>
                   <span class="mf">0.08694899</span><span class="p">,</span> <span class="mf">0.08513801</span><span class="p">,</span> <span class="mf">0.08373001</span><span class="p">,</span> <span class="mf">0.08292177</span><span class="p">,</span> <span class="mf">0.08236026</span><span class="p">,</span> <span class="mf">0.08223461</span><span class="p">,</span> <span class="mf">0.08220564</span><span class="p">,</span> <span class="mf">0.08247615</span><span class="p">,</span> <span class="mf">0.0827256</span><span class="p">,</span> <span class="mf">0.0832465</span><span class="p">,</span> <span class="mf">0.08456729</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.06996611</span><span class="p">,</span> <span class="mf">0.07250687</span><span class="p">,</span> <span class="mf">0.07466939</span><span class="p">,</span> <span class="mf">0.07500611</span><span class="p">,</span> <span class="mf">0.07410654</span><span class="p">,</span> <span class="mf">0.07300714</span><span class="p">,</span> <span class="mf">0.07191716</span><span class="p">,</span> <span class="mf">0.07126404</span><span class="p">,</span> <span class="mf">0.07080229</span><span class="p">,</span> <span class="mf">0.07072385</span><span class="p">,</span> <span class="mf">0.07069991</span><span class="p">,</span>
                   <span class="mf">0.07091747</span><span class="p">,</span> <span class="mf">0.07107363</span><span class="p">,</span> <span class="mf">0.07138765</span><span class="p">,</span> <span class="mf">0.07158516</span><span class="p">,</span> <span class="mf">0.07190796</span><span class="p">,</span> <span class="mf">0.07210113</span><span class="p">,</span> <span class="mf">0.07243694</span><span class="p">,</span> <span class="mf">0.07272244</span><span class="p">,</span> <span class="mf">0.07309388</span><span class="p">,</span> <span class="mf">0.07318622</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.10459769</span><span class="p">,</span> <span class="mf">0.10714292</span><span class="p">,</span> <span class="mf">0.10847073</span><span class="p">,</span> <span class="mf">0.10738268</span><span class="p">,</span> <span class="mf">0.10580067</span><span class="p">,</span> <span class="mf">0.10463459</span><span class="p">,</span> <span class="mf">0.10399859</span><span class="p">,</span> <span class="mf">0.10375836</span><span class="p">,</span> <span class="mf">0.10374181</span><span class="p">,</span> <span class="mf">0.10383653</span><span class="p">,</span> <span class="mf">0.10396538</span><span class="p">,</span>
                   <span class="mf">0.10410001</span><span class="p">,</span> <span class="mf">0.10421888</span><span class="p">,</span> <span class="mf">0.10432586</span><span class="p">,</span> <span class="mf">0.10441817</span><span class="p">,</span> <span class="mf">0.10451517</span><span class="p">,</span> <span class="mf">0.10463752</span><span class="p">,</span> <span class="mf">0.10483768</span><span class="p">,</span> <span class="mf">0.10511517</span><span class="p">,</span> <span class="mf">0.10537128</span><span class="p">,</span> <span class="mf">0.10597695</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.14939687</span><span class="p">,</span> <span class="mf">0.15640947</span><span class="p">,</span> <span class="mf">0.15673244</span><span class="p">,</span> <span class="mf">0.15218987</span><span class="p">,</span> <span class="mf">0.14859712</span><span class="p">,</span> <span class="mf">0.14695313</span><span class="p">,</span> <span class="mf">0.1465719</span><span class="p">,</span> <span class="mf">0.14673995</span><span class="p">,</span> <span class="mf">0.14705303</span><span class="p">,</span> <span class="mf">0.14734157</span><span class="p">,</span> <span class="mf">0.14755549</span><span class="p">,</span>
                   <span class="mf">0.1476938</span><span class="p">,</span> <span class="mf">0.14777069</span><span class="p">,</span> <span class="mf">0.1478045</span><span class="p">,</span> <span class="mf">0.14781535</span><span class="p">,</span> <span class="mf">0.14782897</span><span class="p">,</span> <span class="mf">0.14787997</span><span class="p">,</span> <span class="mf">0.14801416</span><span class="p">,</span> <span class="mf">0.14831035</span><span class="p">,</span> <span class="mf">0.1490566</span><span class="p">,</span> <span class="mf">0.15126877</span><span class="p">]])</span>

<span class="c1"># species C</span>
<span class="n">var_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.13761351</span><span class="p">,</span> <span class="mf">0.14268368</span><span class="p">,</span> <span class="mf">0.151495</span><span class="p">,</span> <span class="mf">0.1575553</span><span class="p">,</span> <span class="mf">0.15967659</span><span class="p">,</span> <span class="mf">0.15902096</span><span class="p">,</span> <span class="mf">0.15653546</span><span class="p">,</span> <span class="mf">0.15349447</span><span class="p">,</span> <span class="mf">0.15030938</span><span class="p">,</span> <span class="mf">0.14763968</span><span class="p">,</span> <span class="mf">0.14539309</span><span class="p">,</span>
                   <span class="mf">0.14387839</span><span class="p">,</span> <span class="mf">0.14278781</span><span class="p">,</span> <span class="mf">0.14231509</span><span class="p">,</span> <span class="mf">0.1421044</span><span class="p">,</span> <span class="mf">0.14234241</span><span class="p">,</span> <span class="mf">0.14268768</span><span class="p">,</span> <span class="mf">0.14334096</span><span class="p">,</span> <span class="mf">0.14397984</span><span class="p">,</span> <span class="mf">0.14489511</span><span class="p">,</span> <span class="mf">0.14661361</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.12716556</span><span class="p">,</span> <span class="mf">0.12970804</span><span class="p">,</span> <span class="mf">0.13188809</span><span class="p">,</span> <span class="mf">0.13227501</span><span class="p">,</span> <span class="mf">0.13146534</span><span class="p">,</span> <span class="mf">0.13049419</span><span class="p">,</span> <span class="mf">0.12956507</span><span class="p">,</span> <span class="mf">0.12909831</span><span class="p">,</span> <span class="mf">0.1288415</span><span class="p">,</span>  <span class="mf">0.12898045</span><span class="p">,</span> <span class="mf">0.1291812</span><span class="p">,</span>
                   <span class="mf">0.12962646</span><span class="p">,</span> <span class="mf">0.1300098</span><span class="p">,</span>  <span class="mf">0.13054754</span><span class="p">,</span> <span class="mf">0.13096292</span><span class="p">,</span> <span class="mf">0.13149577</span><span class="p">,</span> <span class="mf">0.13188955</span><span class="p">,</span> <span class="mf">0.13241524</span><span class="p">,</span> <span class="mf">0.1328789</span><span class="p">,</span> <span class="mf">0.13341603</span><span class="p">,</span> <span class="mf">0.13366104</span><span class="p">],</span> 
                  <span class="p">[</span><span class="mf">0.16179714</span><span class="p">,</span> <span class="mf">0.16434671</span><span class="p">,</span> <span class="mf">0.16571033</span><span class="p">,</span> <span class="mf">0.16470349</span><span class="p">,</span> <span class="mf">0.16323702</span><span class="p">,</span> <span class="mf">0.16220358</span><span class="p">,</span> <span class="mf">0.16170392</span><span class="p">,</span> <span class="mf">0.16159574</span><span class="p">,</span> <span class="mf">0.16170286</span><span class="p">,</span> <span class="mf">0.16191099</span><span class="p">,</span> <span class="mf">0.16214216</span><span class="p">,</span>
                   <span class="mf">0.16236761</span><span class="p">,</span> <span class="mf">0.1625656</span><span class="p">,</span> <span class="mf">0.16273996</span><span class="p">,</span> <span class="mf">0.16288795</span><span class="p">,</span> <span class="mf">0.1630292</span><span class="p">,</span> <span class="mf">0.16318473</span><span class="p">,</span> <span class="mf">0.16340753</span><span class="p">,</span> <span class="mf">0.16369774</span><span class="p">,</span> <span class="mf">0.16395741</span><span class="p">,</span> <span class="mf">0.16455827</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.20659632</span><span class="p">,</span> <span class="mf">0.21363847</span><span class="p">,</span> <span class="mf">0.21416268</span><span class="p">,</span> <span class="mf">0.20998773</span><span class="p">,</span> <span class="mf">0.20681539</span><span class="p">,</span> <span class="mf">0.2055619</span><span class="p">,</span> <span class="mf">0.20550853</span><span class="p">,</span> <span class="mf">0.20593768</span><span class="p">,</span> <span class="mf">0.2064511</span><span class="p">,</span>  <span class="mf">0.20688658</span><span class="p">,</span>  <span class="mf">0.20720041</span><span class="p">,</span> 
                   <span class="mf">0.20739674</span><span class="p">,</span> <span class="mf">0.20749437</span><span class="p">,</span> <span class="mf">0.20751608</span><span class="p">,</span> <span class="mf">0.20748645</span><span class="p">,</span> <span class="mf">0.20743568</span><span class="p">,</span> <span class="mf">0.2074028</span><span class="p">,</span> <span class="mf">0.20743782</span><span class="p">,</span> <span class="mf">0.20762347</span><span class="p">,</span> <span class="mf">0.20825134</span><span class="p">,</span> <span class="mf">0.21034041</span><span class="p">]])</span>

<span class="c1"># set controls for predictions:</span>
<span class="n">t_star</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">Npred</span><span class="p">)</span> <span class="c1"># range of times we wish to predict over</span>
    
<span class="n">T_star</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">300.00</span><span class="p">,</span><span class="mf">350.00</span><span class="p">,</span><span class="mf">400.00</span><span class="p">,</span><span class="mf">450.00</span><span class="p">])</span> <span class="c1"># range of temperatures we wish to predict over</span>

<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">T_star</span><span class="p">)</span> <span class="o">==</span> <span class="n">Ntemp</span><span class="p">,</span> <span class="s2">&quot;Dimension mismatch&quot;</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">Nobs</span><span class="p">)</span> <span class="c1"># time-series used to generate ζ</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we create the four subplots.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a figure of 2x2 subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Ntemp</span><span class="p">):</span>

        <span class="c1">## some conditional formatting:</span>
        <span class="c1"># determine the location of each subplot [a,b] and its subplot title (i-iv+temperature)</span>
        <span class="c1"># to be displayed in subplot corner of choice (anch = &#39;NW,SW,..etc.&#39;)</span>

        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># T = 300 K</span>
            <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span> 
            <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">anch</span> <span class="o">=</span> <span class="s1">&#39;SE&#39;</span> <span class="c1"># South East</span>
            <span class="n">tit</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(i) &#39;</span> 

        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># T = 350 K</span>
            <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">anch</span> <span class="o">=</span> <span class="s1">&#39;SW&#39;</span> <span class="c1"># Soutwest</span>
            <span class="n">tit</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(ii) &#39;</span>

        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="c1"># T = 400 K</span>
            <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">anch</span> <span class="o">=</span> <span class="s1">&#39;SE&#39;</span> <span class="c1"># South East</span>
            <span class="n">tit</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(iii) &#39;</span>

        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span> <span class="c1"># T= 450 K</span>
            <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">anch</span> <span class="o">=</span> <span class="s1">&#39;SW&#39;</span> <span class="c1"># South West</span>
            <span class="n">tit</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(iv) &#39;</span>

        <span class="c1"># set plot properties once so they can be easily changed later</span>
        <span class="n">lin_styl</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span> <span class="c1"># set linestyle</span>
        <span class="n">mrk_siz</span> <span class="o">=</span> <span class="mi">8</span> <span class="c1"># set markersize</span>
        <span class="n">lin_wdth</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># set linewidth</span>
        <span class="n">shade_intensity</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1"># set shade intensity</span>
        
        <span class="c1"># plot observations on subplot axes[a,b]</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_a</span><span class="p">[</span><span class="n">j</span><span class="p">,:],</span><span class="s1">&#39;bv&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="n">mrk_siz</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_b</span><span class="p">[</span><span class="n">j</span><span class="p">,:],</span><span class="s1">&#39;gs&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="n">mrk_siz</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_c</span><span class="p">[</span><span class="n">j</span><span class="p">,:],</span><span class="s1">&#39;rd&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="n">mrk_siz</span><span class="p">)</span>
        
        <span class="c1"># plot hybrid model predictions</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_star</span><span class="p">,</span> <span class="n">y_a_star</span><span class="p">[</span><span class="n">j</span><span class="p">,:],</span><span class="s1">&#39;b&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lin_styl</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$C_A$&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="n">lin_wdth</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="n">mrk_siz</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_star</span><span class="p">,</span> <span class="n">y_b_star</span><span class="p">[</span><span class="n">j</span><span class="p">,:],</span><span class="s1">&#39;g&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lin_styl</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$C_B$&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="n">lin_wdth</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="n">mrk_siz</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_star</span><span class="p">,</span> <span class="n">y_c_star</span><span class="p">[</span><span class="n">j</span><span class="p">,:],</span><span class="s1">&#39;r&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lin_styl</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$C_A$&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="n">lin_wdth</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="n">mrk_siz</span><span class="p">)</span>

        <span class="c1"># shade +/- one standard deviation from prediction</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t_star</span><span class="p">,</span> <span class="n">y_a_star</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span> <span class="o">-</span> <span class="n">var_a</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> 
                              <span class="n">y_a_star</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span> <span class="o">+</span> <span class="n">var_a</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">shade_intensity</span><span class="p">)</span>
        
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t_star</span><span class="p">,</span> <span class="n">y_b_star</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span> <span class="o">-</span> <span class="n">var_b</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> 
                              <span class="n">y_b_star</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span> <span class="o">+</span> <span class="n">var_b</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">shade_intensity</span><span class="p">)</span>
        
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t_star</span><span class="p">,</span> <span class="n">y_c_star</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span> <span class="o">-</span> <span class="n">var_c</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> 
                              <span class="n">y_c_star</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span> <span class="o">+</span> <span class="n">var_c</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span><span class="o">**</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">shade_intensity</span><span class="p">)</span>
        
        <span class="c1"># set no. of decimal places for axes labels</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span><span class="p">))</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span><span class="p">))</span>
        
        <span class="c1"># set tick marks insize plot, re-size axis labels</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">labelsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
        
        <span class="c1"># create subplot label for temperature</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">2.25</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">tit</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;T = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">T_star</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; (K)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        
        <span class="c1"># set bounds for plotting</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="c1">## make the plots square-shaped:</span>

        <span class="c1"># define y-unit to x-unit ratio</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="mf">1.0</span>
        
        <span class="c1"># get x and y limits</span>
        <span class="n">x_left</span><span class="p">,</span> <span class="n">x_right</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">y_low</span><span class="p">,</span> <span class="n">y_high</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        
        <span class="c1">#set aspect ratio</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="n">x_right</span><span class="o">-</span><span class="n">x_left</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">y_low</span><span class="o">-</span><span class="n">y_high</span><span class="p">))</span><span class="o">*</span><span class="n">ratio</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="n">anch</span><span class="p">)</span> 

<span class="c1"># for the entire plot: </span>

<span class="c1"># optional : include a figure title</span>
<span class="c1"># fig.suptitle(&#39;Hybrid model predictions with epistemic and aleatoric uncertainty&#39;, fontsize = 16, fontweight = &#39;bold&#39;)</span>

<span class="c1"># remove repitive axis and tick labels</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_axes</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">label_outer</span><span class="p">()</span>

<span class="c1"># set axis labels</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;t (h)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C (M)&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># optional: manually tune spacing between plots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span> <span class="o">=</span> <span class="mf">0.92</span><span class="p">,</span> <span class="n">wspace</span> <span class="o">=</span> <span class="mf">0.12</span><span class="p">,</span> <span class="n">hspace</span> <span class="o">=</span> <span class="mf">0.08</span><span class="p">)</span>
        
<span class="c1"># create a custom legend for plot</span>
<span class="n">legend_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\bf</span><span class="si">{A}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="n">mrk_siz</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\bf</span><span class="si">{B}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="n">mrk_siz</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\bf</span><span class="si">{C}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="n">mrk_siz</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="n">lin_styl</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\mathcal</span><span class="si">{M}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="n">lin_wdth</span><span class="p">)]</span>

<span class="c1"># place legend</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span> <span class="o">=</span> <span class="n">legend_elements</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">frameon</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1"># optional: save in desired format</span>
<span class="n">path_to_fig</span> <span class="o">=</span> <span class="s1">&#39;example_fig&#39;</span>
<span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;.pdf&#39;</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path_to_fig</span> <span class="o">+</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">1200</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/e3b283a20840fe7d8acd7da875145baf2fbf2291252c1cf8e47f302e1f8e9576.png" src="../../_images/e3b283a20840fe7d8acd7da875145baf2fbf2291252c1cf8e47f302e1f8e9576.png" />
</div>
</div>
</section>
<section id="example-bar-charts-for-sensitivity-analysis">
<h2><span class="section-number">1.15.5. </span>Example: Bar Charts for Sensitivity Analysis<a class="headerlink" href="#example-bar-charts-for-sensitivity-analysis" title="Link to this heading">#</a></h2>
<p>In this example, prepared by <a class="reference external" href="https://github.com/MadelynnWatson">Maddie Watson</a>, we plot results from a techneconomic sensitivity analysis. This plot is adapted from:</p>
<p>C. O’Brien, M. Watson, A. Dowling (2022). Challenges and Opportunities in Converting CO2 to Carbohydrates. <em>under review</em> <a class="reference external" href="https://github.com/dowlinglab/CO2-to-carbs-analysis/blob/main/Watson_supporting_calculations.ipynb">code</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Organize Data into Pandas Dataframe</span>

<span class="c1"># Values are put into a pandas data frame so they can be sorted</span>
<span class="c1"># params is the parameter name of each bar </span>
<span class="c1"># values is the difference between the max and min of the parameter variation (bar width)</span>
<span class="c1"># start is the minimum point of the parameter variation and defines the starting value of each bar</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="nb">dict</span><span class="p">(</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Parameter 1&#39;</span><span class="p">,</span><span class="s1">&#39;Parameter 2&#39;</span><span class="p">,</span><span class="s1">&#39;Parameter 3&#39;</span><span class="p">,</span><span class="s1">&#39;Parameter 4&#39;</span><span class="p">,</span><span class="s1">&#39;Parameter 5&#39;</span><span class="p">,</span><span class="s1">&#39;Parameter 6&#39;</span><span class="p">],</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
        <span class="n">start</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">15</span><span class="p">]</span>
  
    <span class="p">)</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        params  values  start
0  Parameter 1     1.0   -3.0
1  Parameter 2     0.5   -2.0
2  Parameter 3     0.8   -2.5
3  Parameter 4     0.4   -2.0
4  Parameter 5     5.0   12.0
5  Parameter 6    10.0   15.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Sort Data Frame</span>

<span class="c1"># The command below sorts the &#39;values&#39; (barwidth) so they are displayed in the diagram as highest to lowest</span>
<span class="c1"># This ensures the tornado-like appearence</span>
<span class="n">df_sorted</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;values&#39;</span><span class="p">)</span>

<span class="c1"># re-index the dataframe to go 0-5 after sorting</span>
<span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">]),</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_sorted</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_sorted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            params  values  start
index                            
0      Parameter 4     0.4   -2.0
1      Parameter 2     0.5   -2.0
2      Parameter 3     0.8   -2.5
3      Parameter 1     1.0   -3.0
4      Parameter 5     5.0   12.0
5      Parameter 6    10.0   15.0
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot Generation</span>

<span class="c1"># Broken axis example</span>
<span class="c1"># To create the broken axis create 2 subplots and merge together</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">p</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="s1">&#39;params&#39;</span><span class="p">,</span><span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_sorted</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="s1">&#39;start&#39;</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="s1">&#39;params&#39;</span><span class="p">,</span><span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_sorted</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="s1">&#39;start&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># Formatting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;GHG Emissions Intensity&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;CO$_2$ Emissions (Gt CO$_2$eq / Gt C$_6$H$_</span><span class="si">{12}</span><span class="s1">$O$_6$)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1"># Add a Nominal line for comparisons</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nominal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nominal&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Limits for left and right of x axis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mi">31</span><span class="p">)</span>

<span class="c1"># Formatting the axis</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>


<span class="c1"># Adding the diagonal lines between broken axis</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">.015</span> <span class="c1"># how big to make the diagonal lines in axes coordinates</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">d</span><span class="p">),(</span><span class="mi">1</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>  <span class="c1"># switch to the bottom axes</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">)</span>

<span class="c1"># Setting bar labels</span>
<span class="c1"># Broke into 2 sections beacuse we are using 2 axis</span>
<span class="c1"># This can be simplified to just loop through the dictionary if you don&#39;t have to specify which axis holds the label</span>
<span class="c1"># left side labels (red bars)</span>
<span class="n">shift_l</span> <span class="o">=</span> <span class="mi">5</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]:</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">shift_l</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Right side labels (red bars)</span>
<span class="n">shift_r</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]:</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">shift_r</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Left side labels (blue bars)</span>
<span class="n">shift_l</span> <span class="o">=</span> <span class="mf">1.3</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">shift_l</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Right side labels (blue bars)</span>
<span class="n">shift_r</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">shift_r</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Save plots to PNG and PDF to publication</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;GHG_emissions_intensity&#39;</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="o">+</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/4b71f47d58433fad8afca35e3a944b0f0ada6978e75b49f9d8676362fa615c0e.png" src="../../_images/4b71f47d58433fad8afca35e3a944b0f0ada6978e75b49f9d8676362fa615c0e.png" />
</div>
</div>
</section>
<section id="example-colored-contour-plots">
<h2><span class="section-number">1.15.6. </span>Example : Colored Contour Plots<a class="headerlink" href="#example-colored-contour-plots" title="Link to this heading">#</a></h2>
<p>Finally, in this example prepared by <a class="reference external" href="https://github.com/dipperwang5">Ke Wang</a>, we prepare a colored contour plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format=&#39;retina&#39;
</pre></div>
</div>
</div>
</div>
<p>We plot the function</p>
<div class="math notranslate nohighlight">
\[z = x^2 + y^2\]</div>
<p>over the domain <span class="math notranslate nohighlight">\(x \in [-5, 5]\)</span> and <span class="math notranslate nohighlight">\(y \in [-5, 5]\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># enumerate samples</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span> 
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span> 
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># extract x-axis and y-axis size</span>
<span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define function for z</span>
<span class="n">z</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># draw figure, using (6,6) because the plot is small otherwise</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="c1"># plot heatmap</span>
<span class="c1">#   cmap defines the overall color within the heatmap </span>
<span class="c1">#   levels: determines the number and positions of the contour lines / regions.</span>
<span class="n">cs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># plot color bar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>

<span class="c1"># plot title in color bar</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x^2 + y^2$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># set font size in color bar</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># plot equipotential line</span>
<span class="c1">#  [::10] means sampling 1 in every 10 samples</span>
<span class="c1">#  colors define the color want to use, &#39;k&#39; for black</span>
<span class="c1">#  alpha is blending value, between 0 (transparent) and 1 (opaque).</span>
<span class="c1">#  linestyle defines the linestyle.</span>
<span class="c1">#  linewidth defines the width of line</span>
<span class="n">cs2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">cs</span><span class="o">.</span><span class="n">levels</span><span class="p">[::</span><span class="mi">15</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># plot the heatmap label</span>
<span class="c1">#  %2.2f means keep to 2 digit</span>
<span class="c1">#  fontsize defines the size of the text in figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs2</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%2.2f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># define tick size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;in&quot;</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># set squared figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">)</span>

<span class="c1"># plot titile and x,y label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># save figure (important for publications)</span>
<span class="c1"># plt.savefig(&#39;heatmap.png&#39;,bbox_inches=&#39;tight&#39;)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/da0efd2bef8f6079a11814e5f314c88419639f2c482dc5457bb02fee3f2d850a.png"><img alt="../../_images/da0efd2bef8f6079a11814e5f314c88419639f2c482dc5457bb02fee3f2d850a.png" src="../../_images/da0efd2bef8f6079a11814e5f314c88419639f2c482dc5457bb02fee3f2d850a.png" style="width: 428px; height: 352px;" /></a>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/01"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Testing-and-Debugging.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.14. </span>Testing and Debugging in Python</p>
      </div>
    </a>
    <a class="right-next"
       href="../02/advanced_python.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Advanced Python</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">1.15.1. Learning Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-makes-a-scientific-figure-look-great">1.15.2. What makes a scientific figure look great?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-data-and-model-predictions">1.15.3. Example: Data and Model Predictions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-predictions-with-uncertainty-bands">1.15.4. Example: Predictions with Uncertainty Bands</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-bar-charts-for-sensitivity-analysis">1.15.5. Example: Bar Charts for Sensitivity Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-colored-contour-plots">1.15.6. Example : Colored Contour Plots</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alexander Dowling, Ryan McClarren, Yamil Colón, et al.
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>